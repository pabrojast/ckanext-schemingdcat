{# CloudStorage integration for SchemingDCAT - Simplified version #}
{# This template provides basic cloudstorage integration without external asset dependencies #}

{% if h.cloudstorage_use_enhanced_upload is defined and h.cloudstorage_use_enhanced_upload() %}
    {# Enhanced upload interface notification #}
    <div class="cloudstorage-enhanced-upload alert alert-info">
        <i class="fa fa-info-circle"></i>
        {{ _('Enhanced upload interface is enabled') }}
    </div>
{% endif %}

{# Basic JavaScript integration - only if cloudstorage helpers are available #}
{% if h.cloudstorage_use_enhanced_upload is defined %}
    <script>
        $(document).ready(function() {
            console.log('[schemingdcat-cloudstorage] CloudStorage integration initialized');
            
            // Check if cloudstorage is configured
            var cloudStorageAvailable = false;
            
            {% if h.cloudstorage_use_enhanced_upload() %}
                cloudStorageAvailable = true;
                console.log('[schemingdcat-cloudstorage] Enhanced upload enabled');
            {% endif %}
            
            {% if h.cloudstorage_use_azure_direct_upload is defined and h.cloudstorage_use_azure_direct_upload() %}
                cloudStorageAvailable = true;
                console.log('[schemingdcat-cloudstorage] Azure direct upload enabled');
            {% endif %}
            
            if (cloudStorageAvailable) {
                // Basic file input enhancement
                var $fileInputs = $('input[type="file"][name="upload"]');
                console.log('[schemingdcat-cloudstorage] Found ' + $fileInputs.length + ' file input(s)');
                
                $fileInputs.each(function() {
                    var $input = $(this);
                    var $form = $input.closest('form');
                    
                    // Add visual indication that cloudstorage is active
                    if (!$input.siblings('.cloudstorage-indicator').length) {
                        $input.after('<small class="cloudstorage-indicator text-muted">' +
                                   '<i class="fa fa-cloud-upload"></i> ' +
                                   '{{ _("CloudStorage enabled") }}' +
                                   '</small>');
                    }
                    
                    // Basic progress indication
                    $input.on('change', function() {
                        if (this.files && this.files.length > 0) {
                            var fileName = this.files[0].name;
                            var fileSize = this.files[0].size;
                            console.log('[schemingdcat-cloudstorage] File selected:', fileName, 'Size:', fileSize);
                            
                            // Update UI to show file selection
                            $input.siblings('.cloudstorage-indicator').html(
                                '<i class="fa fa-file"></i> ' + fileName + 
                                ' <span class="text-success">{{ _("Ready for upload") }}</span>'
                            );
                        }
                    });
                });
            } else {
                console.log('[schemingdcat-cloudstorage] CloudStorage not configured, using standard upload');
            }
        });
    </script>
{% else %}
    {# Fallback: cloudstorage not available #}
    <script>
        console.log('[schemingdcat-cloudstorage] CloudStorage helpers not available, using standard upload');
    </script>
{% endif %} 