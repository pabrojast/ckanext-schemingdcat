{% asset 'css/ft-syntax-highlight.min.css' %}

<div class="panel panel-default">
  <div class="panel-heading">
    <a class="accordion-toggle" data-toggle="collapse" data-parent="accordion2" href="#collapse-r">{{ _('Example: R') }} &raquo;</a>
  </div>

  <div id="collapse-r" class="panel-collapse collapse">
    <div class="panel-body">
      <div class="panel panel-default">
        <div class="panel-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#collapse-r" href="#collapse-r-example1">{{ _('Query example (first 5 results)') }}</a>
        </div>
        <div id="collapse-r-example1" class="panel-collapse collapse">
          <div class="panel-body">
            <pre class="ft-syntax-highlight" data-syntax="r" data-syntax-theme="one-dark" style="font-size:12px">
<code>

<span class="identifier">library</span>(<span class="string">httr2</span>)

<span class="identifier">req</span> &lt;- <span class="identifier">request</span>("<span class="url">{{ h.url_for('api.action', ver=3, logic_function='datastore_search', qualified=True) }}</span>")
<span class="identifier">result</span> &lt;- <span class="identifier">req</span> %&gt;% 
    <span class="identifier">req_headers</span>(<span class="property">Authorization</span> = <span class="identifier">API_TOKEN</span>) %>% 
    <span class="identifier">req_body_json</span>(<span class="identifier">list</span>(
        <span class="property">resource_id</span> = '<span class="value">{{ resource_id }}</span>',
        <span class="property">limit</span> = <span class="number">5</span>))
    <span class="identifier">req_perform</span> <span class="operand">%&gt;%</span> 
    <span class="identifier">resp_body_json</span>
</code>
            </pre>
          </div>
        </div>
      </div>

      <div class="panel panel-default">
          <div class="panel-heading">
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#collapse-r" href="#collapse-r-example2">{{ _('Query example (results containing \'medio-ambiente\')') }}</a>
          </div>
          <div id="collapse-r-example2" class="panel-collapse collapse">
            <div class="panel-body">
              <pre class="ft-syntax-highlight" data-syntax="r" data-syntax-theme="one-dark" style="font-size:12px">
<code>

  <span class="identifier">library</span>(<span class="string">httr2</span>)

  <span class="identifier">req</span> &lt;- <span class="identifier">request</span>("<span class="url">{{ h.url_for('api.action', ver=3, logic_function='datastore_search', qualified=True) }}</span>")
  <span class="identifier">result</span> &lt;- <span class="identifier">req</span> %&gt;% 
      <span class="identifier">req_headers</span>(<span class="property">Authorization</span> = <span class="identifier">API_TOKEN</span>) %>% 
      <span class="identifier">req_body_json</span>(<span class="identifier">list</span>(
          <span class="property">resource_id</span> = '<span class="value">{{ resource_id }}</span>',
          <span class="property">filters</span> = list(<span class="property">'medio-ambiente'</span>),
          stage = "<span class="value">active</span>"))
      <span class="identifier">req_perform</span> <span class="operand">%&gt;%</span> 
      <span class="identifier">resp_body_json</span>
</code>
              </pre>
            </div>
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading">
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#collapse-r" href="#collapse-r-example3">{{ _('Query example (via SQL statement)') }}</a>
          </div>
          <div id="collapse-r-example3" class="panel-collapse collapse">
            <div class="panel-body">
              <pre class="ft-syntax-highlight" data-syntax="r" data-syntax-theme="one-dark" style="font-size:12px">
<code>

<span class="identifier">library</span>(<span class="string">httr2</span>)

<span class="identifier">req</span> &lt;- <span class="identifier">request</span>("<span class="url">{{ h.url_for('api.action', ver=3, logic_function='datastore_search_sql', qualified=True) }}</span>")
<span class="identifier">result</span> &lt;- <span class="identifier">req</span> %&gt;% 
    <span class="identifier">req_headers</span>(<span class="property">Authorization</span> = <span class="identifier">API_TOKEN</span>) %>% 
    <span class="identifier">req_body_json</span>(<span class="identifier">list</span>(
      <span class="parameter">sql</span>="<span class="string">SELECT * from "<span class="value">{{ resource_id }}</span>" WHERE title LIKE 'medio-ambiente'</span>")
    <span class="identifier">req_perform</span> <span class="operand">%&gt;%</span> 
    <span class="identifier">resp_body_json</span>
</code>
              </pre>
            </div>
          </div>
        </div>


    </div>
  </div>
</div>